<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ê–¥–≤–æ–∫–∞—Ç –ö–†</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Mulish:wght@400;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e27;--surface:#1a1f3a;--surface2:#0f172a;--border:rgba(148,163,184,0.2);--text:#e2e8f0;--text-dim:#94a3b8;--accent:#3b82f6;--gold:#f59e0b;--success:#10b981}
body{font-family:'Mulish',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
.loading{position:fixed;top:0;left:0;right:0;bottom:0;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}
.loading-spinner{width:50px;height:50px;border:4px solid var(--surface2);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{margin-top:20px;color:var(--text-dim);font-size:0.9rem}
.topbar{background:var(--surface);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100}
.logo{font-family:'Playfair Display',serif;font-size:1.4rem;color:var(--gold);display:flex;align-items:center;gap:8px}
.topbar-right{display:flex;align-items:center;gap:16px}
.lang-btn{padding:8px 16px;background:transparent;border:1px solid var(--border);border-radius:8px;color:var(--text-dim);cursor:pointer;font-size:0.85rem;transition:all 0.2s}
.lang-btn.active{background:var(--accent);border-color:var(--accent);color:white}
.btn-admin{padding:8px 16px;background:linear-gradient(135deg,var(--gold),#d97706);border:none;border-radius:8px;color:white;font-weight:700;cursor:pointer;font-size:0.85rem}
.topbar-user{color:var(--text-dim);font-size:0.9rem}
.main{display:grid;grid-template-columns:280px 1fr;min-height:calc(100vh - 64px)}
.sidebar{background:var(--surface);border-right:1px solid var(--border);padding:24px 16px;overflow-y:auto;max-height:calc(100vh - 64px);position:sticky;top:64px}
.sidebar h3{font-size:0.75rem;text-transform:uppercase;color:var(--text-dim);letter-spacing:0.5px;margin:24px 0 12px}
.mode-btn{width:100%;padding:12px 16px;background:var(--surface2);border:2px solid transparent;border-radius:10px;color:var(--text);font-size:0.9rem;cursor:pointer;margin:6px 0;transition:all 0.2s;display:flex;align-items:center;gap:8px;text-align:left}
.mode-btn.active{border-color:var(--accent);background:rgba(59,130,246,0.1)}
.mode-btn:hover{border-color:var(--border)}
.content{padding:32px;max-width:800px;margin:0 auto;width:100%}
.question-card{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:28px;margin-bottom:24px;box-shadow:0 4px 30px rgba(0,0,0,0.3)}
.q-number{color:var(--text-dim);font-size:0.85rem;margin-bottom:12px}
.q-section{color:var(--accent);font-size:0.85rem;margin-bottom:8px}
.q-text{font-size:1.1rem;margin-bottom:24px;padding:20px;background:rgba(236,72,153,0.1);border:2px solid rgba(236,72,153,0.3);border-radius:14px;color:#fce7f3;line-height:1.6}
.options{display:flex;flex-direction:column;gap:10px}
.option{padding:16px 20px;background:var(--surface2);border:2px solid transparent;border-radius:14px;cursor:pointer;font-size:0.95rem;line-height:1.55;transition:all 0.2s;word-wrap:break-word}
.option:hover{border-color:var(--accent);background:#1e293b}
.option.correct{border-color:var(--success);background:rgba(16,185,129,0.1)}
.nav-buttons{display:flex;justify-content:space-between;margin-top:24px;align-items:center}
button{padding:12px 24px;background:var(--accent);border:none;border-radius:12px;color:white;font-weight:700;cursor:pointer;transition:all 0.2s;font-size:0.9rem}
button:hover{background:#2563eb;transform:translateY(-2px)}
.counter{color:var(--text-dim);font-size:0.9rem}
@media(max-width:768px){.main{grid-template-columns:1fr}.sidebar{display:none}.content{padding:16px}}
</style>
</head>
<body>

<div class="loading" id="loading">
<div class="loading-spinner"></div>
<div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤...</div>
</div>

<div id="app" style="display:none">
<div class="topbar">
<div class="logo">‚öñÔ∏è –ê–¥–≤–æ–∫–∞—Ç –ö–†</div>
<div class="topbar-right">
<button class="lang-btn active" id="langRu" onclick="setLang('ru')">–†–£–°</button>
<button class="lang-btn" id="langKy" onclick="setLang('ky')">–ö–´–†</button>
<button class="btn-admin" onclick="if(sessionStorage.getItem('user')==='admin')openAdmin();else alert('–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è admin')" style="display:none" id="adminBtn">‚öôÔ∏è –ê–¥–º–∏–Ω</button>
<span class="topbar-user">üë§ <span id="username">Demo</span></span>
<a href="index.html" onclick="sessionStorage.clear()" style="color:var(--gold);text-decoration:none;font-size:0.85rem">–í—ã—Ö–æ–¥</a>
</div>
</div>

<div class="main">
<div class="sidebar">
<h3>–†–ï–ñ–ò–ú</h3>
<button class="mode-btn active" id="modeStudy" onclick="setMode('study')">üìñ <span>–û–±—É—á–µ–Ω–∏–µ</span></button>
<button class="mode-btn" id="modeTest" onclick="setMode('test')">üìù <span>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span></button>
<h3>–ò–ù–°–¢–†–£–ú–ï–ù–¢–´</h3>
<button class="mode-btn" onclick="shuffleQuestions()">üîÑ –ü–µ—Ä–µ–º–µ—à–∞—Ç—å</button>
<button class="mode-btn" onclick="alert('–§—É–Ω–∫—Ü–∏—è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
<button class="mode-btn" onclick="alert('–§—É–Ω–∫—Ü–∏—è –û—à–∏–±–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">‚ùå –û—à–∏–±–∫–∏</button>
</div>

<div class="content">
<div class="question-card">
<div class="q-number" id="qNum"></div>
<div class="q-section" id="qSection"></div>
<div class="q-text" id="qText"></div>
<div class="options" id="options"></div>
</div>
<div class="nav-buttons">
<button onclick="prev()">‚Üê –ù–∞–∑–∞–¥</button>
<div class="counter" id="counter"></div>
<button onclick="next()">–î–∞–ª–µ–µ ‚Üí</button>
</div>
</div>
</div>
</div>

<script>
const user=sessionStorage.getItem('user');
if(!user){window.location.href='index.html';}
document.getElementById('username').textContent=user;
if(user==='admin')document.getElementById('adminBtn').style.display='inline-block';

let DATA={ru:[],ky:[]},lang='ru',mode='study',cur=0,allQ=[],filtered=[];

async function loadData(){
try{
const res=await fetch('data.json');
DATA=await res.json();
console.log('‚úÖ Loaded',DATA.ru.length,'RU sections,',DATA.ky.length,'KY sections');
buildQuestions();
showQ();
document.getElementById('loading').style.display='none';
document.getElementById('app').style.display='block';
}catch(e){
console.error('‚ùå Failed to load data:',e);
document.querySelector('.loading-text').textContent='–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.';
}
}

function buildQuestions(){
const d=DATA[lang];
allQ=[];
d.forEach(sec=>sec.questions.forEach(q=>allQ.push({section:sec.section,text:q.text,options:q.options})));
filtered=[...allQ];
}

function showQ(){
const q=filtered[cur];
if(!q)return;
document.getElementById('qNum').textContent=`–í–æ–ø—Ä–æ—Å ${cur+1} –∏–∑ ${filtered.length}`;
document.getElementById('qSection').textContent=q.section;
document.getElementById('qText').textContent=q.text;
const opts=document.getElementById('options');
opts.innerHTML=q.options.map((o,i)=>`<div class="option ${mode==='study'&&o.correct?'correct':''}">${i+1}. ${o.text}</div>`).join('');
document.getElementById('counter').textContent=`${cur+1} / ${filtered.length}`;
window.scrollTo(0,0);
}

function prev(){if(cur>0){cur--;showQ();}}
function next(){if(cur<filtered.length-1){cur++;showQ();}}
function setMode(m){
mode=m;
document.getElementById('modeStudy').classList.toggle('active',m==='study');
document.getElementById('modeTest').classList.toggle('active',m==='test');
showQ();
}
function setLang(l){
lang=l;
document.getElementById('langRu').classList.toggle('active',l==='ru');
document.getElementById('langKy').classList.toggle('active',l==='ky');
buildQuestions();
cur=0;
showQ();
}
function shuffleQuestions(){
for(let i=filtered.length-1;i>0;i--){
const j=Math.floor(Math.random()*(i+1));
[filtered[i],filtered[j]]=[filtered[j],filtered[i]];
}
cur=0;
showQ();
}
function openAdmin(){alert('–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');}

loadData();
</script>
</body>
</html>
